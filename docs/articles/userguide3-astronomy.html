<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Guide: 3 Astronomy • photobiology</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">photobiology</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../reference/photobiology-package.html">About</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>User Guide: 3 Astronomy</h1>
            <h3 class="subtitle">Package ‘photobiology’ 0.9.15.9000</h3>
                        <h4 class="author">Pedro J. Aphalo</h4>
            
            <h4 class="date">2017-06-18</h4>
          </div>

    
    
<div class="contents">
<div id="getting-started" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h3>
<p>We load two packages, our ‘<strong>photobiology</strong>’ and ‘<strong>lubridate</strong>’, as they will be used in the examples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(photobiology)
<span class="kw">library</span>(lubridate)</code></pre></div>
<pre><code>## 
## Attaching package: 'lubridate'</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     date</code></pre>
</div>
<div id="astronomy" class="section level2">
<h2 class="hasAnchor">
<a href="#astronomy" class="anchor"></a>Astronomy</h2>
<p>The functions and methods described in this section return either values that represent angles or times. In the current version angles are always expressed in degrees. In the case of times, the unit of expression, can be changed through parameter <code>unit.out</code> which accepts the following arguments <code>"datetime"</code>, <code>"hour"</code>, <code>"minute"</code>, <code>"second"</code>. For backwards compatibility <code>"date"</code> is also accepted as equivalent to <code>"datetime"</code> but deprecated.</p>
<div id="position-of-the-sun" class="section level3">
<h3 class="hasAnchor">
<a href="#position-of-the-sun" class="anchor"></a>Position of the sun</h3>
<p>In photobiology research we sometimes need to calculate the position on the sun at arbitrary geographic locations and times. The function <code>sun_angles</code> returns the azimuth in degrees eastwards, altitude in degrees above the horizon, solar disk diameter in degrees and sun to earth distance in astronomical units. The time should be a <code>POSIXct</code> vector, possibly of length one. The easiest way create date and time constant values is to use package <code>lubridate</code>.</p>
<hr>
In versions up to 0.9.11 in addition parameter <code>geocode</code> most functions also had the redundant formal parameters <code>lon</code> and <code>lat</code> which were removed in version 0.9.12. This change may require users’ scripts to be revised.
<hr>
In versions 0.9.16 and later the code has been optimized for performance with time vectors, making massive calculations such as the sun position for every minute of the year quite fast (couple of seconds). We keep, however, examples with rather short vectors.
<hr>
<p>For calculation of the position of the sun we need to supply geographic coordinates and a time instant. The object to be supplied as argument for <code>geocode</code> is a data frame with variables <code>lon</code> and <code>lat</code> giving the location of Earth. This matches the return value of function <code>ggmap::geocode()</code>, function that can be used to find the coordinates using any <em>address</em> entered as a character string understood by the Google maps API. We save the “geocode” for Helsinki.</p>
<p>Be aware that to obtain results based on local time, the correct time zone needs to be set. In the examples we use functions from package ‘lubridate’ for working with times and dates. The argument passed to parameter <code>time</code> can be a “vector” of <code>POSIXct</code> values. The returned value is a <code>data.frame</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.geocode &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lat =</span> <span class="fl">60.16</span>, <span class="dt">lon =</span> <span class="fl">24.93</span>, <span class="dt">address =</span> <span class="st">"Helsinki, Finland"</span>)</code></pre></div>
<p>The position of the sun at Helsinki, at the time the file you are eading was generated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sun_angles.html">sun_angles</a></span>(<span class="dt">time =</span> <span class="kw">now</span>(<span class="dt">tzone =</span> <span class="st">"EET"</span>), <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>##                  time  tz solartime longitude latitude           address
## 1 2017-06-18 12:48:17 EET  11:26:46     24.93    60.16 Helsinki, Finland
##    azimuth elevation
## 1 167.3336  52.79735</code></pre>
<p>Functions have defaults for their arguments, but rarely Greewich will be the location you are interested in.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sun_angles.html">sun_angles</a></span>()</code></pre></div>
<pre><code>##                  time tz solartime longitude latitude   address  azimuth
## 1 2017-06-18 12:48:17     09:47:03         0     51.5 Greenwich 125.0865
##   elevation
## 1  52.07247</code></pre>
<p>A vector of times is accepted as argument, and as perfromance is optimized for this case, <em>vectorization</em> will markedly improve performance compared to multiple calls to the function. The vector of times can be created on the fly, or saved.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sun_angles.html">sun_angles</a></span>(<span class="dt">time =</span> <span class="kw">ymd_hms</span>(<span class="st">"2014-01-01 0:0:0"</span>, <span class="dt">tz =</span> <span class="st">"EET"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">hours</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">23</span>), 
           <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>##                   time  tz solartime longitude latitude           address
## 1  2014-01-01 00:00:00 EET  23:36:18     24.93    60.16 Helsinki, Finland
## 2  2014-01-01 01:00:00 EET  24:36:17     24.93    60.16 Helsinki, Finland
## 3  2014-01-01 02:00:00 EET  01:36:15     24.93    60.16 Helsinki, Finland
## 4  2014-01-01 03:00:00 EET  02:36:14     24.93    60.16 Helsinki, Finland
## 5  2014-01-01 04:00:00 EET  03:36:13     24.93    60.16 Helsinki, Finland
## 6  2014-01-01 05:00:00 EET  04:36:12     24.93    60.16 Helsinki, Finland
## 7  2014-01-01 06:00:00 EET  05:36:11     24.93    60.16 Helsinki, Finland
## 8  2014-01-01 07:00:00 EET  06:36:10     24.93    60.16 Helsinki, Finland
## 9  2014-01-01 08:00:00 EET  07:36:08     24.93    60.16 Helsinki, Finland
## 10 2014-01-01 09:00:00 EET  08:36:07     24.93    60.16 Helsinki, Finland
## 11 2014-01-01 10:00:00 EET  09:36:06     24.93    60.16 Helsinki, Finland
## 12 2014-01-01 11:00:00 EET  10:36:05     24.93    60.16 Helsinki, Finland
## 13 2014-01-01 12:00:00 EET  11:36:04     24.93    60.16 Helsinki, Finland
## 14 2014-01-01 13:00:00 EET  12:36:03     24.93    60.16 Helsinki, Finland
## 15 2014-01-01 14:00:00 EET  13:36:01     24.93    60.16 Helsinki, Finland
## 16 2014-01-01 15:00:00 EET  14:36:00     24.93    60.16 Helsinki, Finland
## 17 2014-01-01 16:00:00 EET  15:35:59     24.93    60.16 Helsinki, Finland
## 18 2014-01-01 17:00:00 EET  16:35:58     24.93    60.16 Helsinki, Finland
## 19 2014-01-01 18:00:00 EET  17:35:57     24.93    60.16 Helsinki, Finland
## 20 2014-01-01 19:00:00 EET  18:35:55     24.93    60.16 Helsinki, Finland
## 21 2014-01-01 20:00:00 EET  19:35:54     24.93    60.16 Helsinki, Finland
## 22 2014-01-01 21:00:00 EET  20:35:53     24.93    60.16 Helsinki, Finland
## 23 2014-01-01 22:00:00 EET  21:35:52     24.93    60.16 Helsinki, Finland
## 24 2014-01-01 23:00:00 EET  22:35:51     24.93    60.16 Helsinki, Finland
##      azimuth  elevation
## 1  350.99883 -52.613245
## 2  346.27111 -52.301194
## 3   35.07235 -49.210394
## 4   53.73084 -43.987865
## 5   69.78930 -37.421418
## 6   83.94626 -30.167070
## 7   96.94086 -22.719139
## 8  109.37682 -15.465810
## 9  121.71097  -8.743375
## 10 134.26821  -2.869260
## 11 147.24096   1.848214
## 12 160.67361   5.124163
## 13 174.45468   6.733197
## 14 188.34832   6.554415
## 15 202.07688   4.601732
## 16 215.42417   1.020190
## 17 228.30893  -3.949251
## 18 240.80648 -10.014555
## 19 253.13678 -16.864925
## 20 265.65055 -24.180278
## 21 278.83259 -31.616747
## 22 293.31626 -38.769093
## 23 309.85336 -45.113571
## 24 329.07544 -49.959917</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.times &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">"2014-01-01 0:0:0"</span>, <span class="dt">tz =</span> <span class="st">"EET"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">hours</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">23</span>)
<span class="kw"><a href="../reference/sun_angles.html">sun_angles</a></span>(<span class="dt">time =</span> my.times, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>##                   time  tz solartime longitude latitude           address
## 1  2014-01-01 00:00:00 EET  23:36:18     24.93    60.16 Helsinki, Finland
## 2  2014-01-01 01:00:00 EET  24:36:17     24.93    60.16 Helsinki, Finland
## 3  2014-01-01 02:00:00 EET  01:36:15     24.93    60.16 Helsinki, Finland
## 4  2014-01-01 03:00:00 EET  02:36:14     24.93    60.16 Helsinki, Finland
## 5  2014-01-01 04:00:00 EET  03:36:13     24.93    60.16 Helsinki, Finland
## 6  2014-01-01 05:00:00 EET  04:36:12     24.93    60.16 Helsinki, Finland
## 7  2014-01-01 06:00:00 EET  05:36:11     24.93    60.16 Helsinki, Finland
## 8  2014-01-01 07:00:00 EET  06:36:10     24.93    60.16 Helsinki, Finland
## 9  2014-01-01 08:00:00 EET  07:36:08     24.93    60.16 Helsinki, Finland
## 10 2014-01-01 09:00:00 EET  08:36:07     24.93    60.16 Helsinki, Finland
## 11 2014-01-01 10:00:00 EET  09:36:06     24.93    60.16 Helsinki, Finland
## 12 2014-01-01 11:00:00 EET  10:36:05     24.93    60.16 Helsinki, Finland
## 13 2014-01-01 12:00:00 EET  11:36:04     24.93    60.16 Helsinki, Finland
## 14 2014-01-01 13:00:00 EET  12:36:03     24.93    60.16 Helsinki, Finland
## 15 2014-01-01 14:00:00 EET  13:36:01     24.93    60.16 Helsinki, Finland
## 16 2014-01-01 15:00:00 EET  14:36:00     24.93    60.16 Helsinki, Finland
## 17 2014-01-01 16:00:00 EET  15:35:59     24.93    60.16 Helsinki, Finland
## 18 2014-01-01 17:00:00 EET  16:35:58     24.93    60.16 Helsinki, Finland
## 19 2014-01-01 18:00:00 EET  17:35:57     24.93    60.16 Helsinki, Finland
## 20 2014-01-01 19:00:00 EET  18:35:55     24.93    60.16 Helsinki, Finland
## 21 2014-01-01 20:00:00 EET  19:35:54     24.93    60.16 Helsinki, Finland
## 22 2014-01-01 21:00:00 EET  20:35:53     24.93    60.16 Helsinki, Finland
## 23 2014-01-01 22:00:00 EET  21:35:52     24.93    60.16 Helsinki, Finland
## 24 2014-01-01 23:00:00 EET  22:35:51     24.93    60.16 Helsinki, Finland
##      azimuth  elevation
## 1  350.99883 -52.613245
## 2  346.27111 -52.301194
## 3   35.07235 -49.210394
## 4   53.73084 -43.987865
## 5   69.78930 -37.421418
## 6   83.94626 -30.167070
## 7   96.94086 -22.719139
## 8  109.37682 -15.465810
## 9  121.71097  -8.743375
## 10 134.26821  -2.869260
## 11 147.24096   1.848214
## 12 160.67361   5.124163
## 13 174.45468   6.733197
## 14 188.34832   6.554415
## 15 202.07688   4.601732
## 16 215.42417   1.020190
## 17 228.30893  -3.949251
## 18 240.80648 -10.014555
## 19 253.13678 -16.864925
## 20 265.65055 -24.180278
## 21 278.83259 -31.616747
## 22 293.31626 -38.769093
## 23 309.85336 -45.113571
## 24 329.07544 -49.959917</code></pre>
<p>When spectra contain suitable metadata, the position of the sun for the spectral irradiance data measurement can be easily obtained.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sun_angles.html">sun_angles</a></span>(<span class="dt">time =</span> <span class="kw"><a href="../reference/getWhenMeasured.html">getWhenMeasured</a></span>(sun.spct), <span class="dt">geocode =</span> <span class="kw"><a href="../reference/getWhereMeasured.html">getWhereMeasured</a></span>(sun.spct))</code></pre></div>
<pre><code>##                  time  tz solartime longitude latitude
## 1 2010-06-22 09:51:00 UTC  11:28:50  24.96474 60.20911
##                            address  azimuth elevation
## 1 kumpula, 00560 helsinki, finland 168.1227  52.82344</code></pre>
<p>One what is needed is only one of the solar angles, functions returning vectors instead of data frames can be useful.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sun_angles.html">sun_elevation</a></span>(<span class="dt">time =</span> my.times, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>##  [1] -52.613245 -52.301194 -49.210394 -43.987865 -37.421418 -30.167070
##  [7] -22.719139 -15.465810  -8.743375  -2.869260   1.848214   5.124163
## [13]   6.733197   6.554415   4.601732   1.020190  -3.949251 -10.014555
## [19] -16.864925 -24.180278 -31.616747 -38.769093 -45.113571 -49.959917</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sun_angles.html">sun_zenith_angle</a></span>(<span class="dt">time =</span> my.times, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>##  [1] 142.61324 142.30119 139.21039 133.98787 127.42142 120.16707 112.71914
##  [8] 105.46581  98.74338  92.86926  88.15179  84.87584  83.26680  83.44558
## [15]  85.39827  88.97981  93.94925 100.01455 106.86492 114.18028 121.61675
## [22] 128.76909 135.11357 139.95992</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sun_angles.html">sun_azimuth</a></span>(<span class="dt">time =</span> my.times, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>##  [1] 350.99883 346.27111  35.07235  53.73084  69.78930  83.94626  96.94086
##  [8] 109.37682 121.71097 134.26821 147.24096 160.67361 174.45468 188.34832
## [15] 202.07688 215.42417 228.30893 240.80648 253.13678 265.65055 278.83259
## [22] 293.31626 309.85336 329.07544</code></pre>
</div>
<div id="times-of-sunrise-solar-noon-and-sunset" class="section level3">
<h3 class="hasAnchor">
<a href="#times-of-sunrise-solar-noon-and-sunset" class="anchor"></a>Times of sunrise, solar noon and sunset</h3>
<p>Functions <code>sunrise_time</code>, <code>sunset_time</code>, <code>noon_time</code>, <code>day_length</code> and <code>night_length</code> have all the same parameter signature. An additional function, <code>day_night</code> returns a data frame containing all the quantities returned by the other functions. They are all vectorized for the <code>date</code> and <code>geocode</code> parameters. As arguments are the same for all these functions, we use <code>sunrise_time</code> in the examples below, but they apply to the other functions described in this section.</p>
<p>We create a vector of dates to use in the examples—default time zone of <code>ymd</code> is UTC.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dates &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">"2015-03-01"</span>, <span class="dt">tz =</span> <span class="st">"EET"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">months</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">5</span>)
dates</code></pre></div>
<pre><code>## [1] "2015-03-01 EET"  "2015-04-01 EEST" "2015-05-01 EEST" "2015-06-01 EEST"
## [5] "2015-07-01 EEST" "2015-08-01 EEST"</code></pre>
<p>Default latitude is zero (the Equator), the default longitude is zero (Greenwich), and default time zone for the functions in the <code>photobiology</code> package is in most cases the time zone returned by the operating system, but values are stored in time zone <code>"UTC"</code>. Be also aware that for summer dates the times are formatted for printing accordingly. In the examples below this can be recognized for example, by the time zone being reported as EEST instead of EET for Eastern Europe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(<span class="dt">date =</span> dates, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] "2015-03-01 07:18:41 EET"  "2015-04-01 06:44:48 EEST"
## [3] "2015-05-01 05:16:45 EEST" "2015-06-01 04:07:34 EEST"
## [5] "2015-07-01 04:01:00 EEST" "2015-08-01 05:00:28 EEST"</code></pre>
<p>As seen above the default for <code>tz</code> is the timezone of the argument passed to <code>date</code>. This can be overriden with an explicit value as argument. In this example, when interpreted in the UTC time zone, the time instants correspond to the previous calendar day compared to the EET time zone. We can also see that “summer time” applies to the EET time zone but not to UTC (universal time coordinates).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(<span class="dt">date =</span> dates, <span class="dt">tz =</span> <span class="st">"UTC"</span>, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] "2015-02-28 05:21:37 UTC" "2015-03-31 03:47:51 UTC"
## [3] "2015-04-30 02:19:30 UTC" "2015-05-31 01:09:05 UTC"
## [5] "2015-06-30 00:59:56 UTC" "2015-07-31 01:58:06 UTC"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">noon_time</a></span>(<span class="dt">date =</span> dates, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] "2015-03-01 12:32:36 EET"  "2015-04-01 13:24:07 EEST"
## [3] "2015-05-01 13:17:22 EEST" "2015-06-01 13:18:07 EEST"
## [5] "2015-07-01 13:24:08 EEST" "2015-08-01 13:26:37 EEST"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunset_time</a></span>(<span class="dt">date =</span> dates, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] "2015-03-01 17:46:32 EET"  "2015-04-01 20:03:27 EEST"
## [3] "2015-05-01 21:18:00 EEST" "2015-06-01 22:28:39 EEST"
## [5] "2015-07-01 22:47:17 EEST" "2015-08-01 21:52:45 EEST"</code></pre>
<p>The default for <code>date</code> is the current day, using the system time zone settings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">noon_time</a></span>(<span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] "2017-06-18 13:21:31 EEST"</code></pre>
<p>Both latitude and longitude should be supplied through <code>geocode</code>, but be aware that if the returned value is desired in the local time coordinates of the argument passed to <code>geocode</code>, the time zone should match the geographic coordinates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(<span class="kw">today</span>(<span class="st">"UTC"</span>), <span class="dt">tz =</span> <span class="st">"UTC"</span>, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] "2017-06-18 00:53:59 UTC"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(<span class="kw">today</span>(<span class="st">"EET"</span>), <span class="dt">tz =</span> <span class="st">"EET"</span>, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] "2017-06-18 03:53:59 EEST"</code></pre>
<p>Southern hemisphere latitudes as well as longitudes to the West of the Greenwich meridian should be supplied as negative numbers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(dates, <span class="dt">geocode =</span> <span class="kw">data.frame</span>(<span class="dt">lat =</span> <span class="dv">60</span>, <span class="dt">lon =</span> <span class="dv">0</span>))</code></pre></div>
<pre><code>## [1] "2015-03-01 08:58:05 EET"  "2015-04-01 08:24:46 EEST"
## [3] "2015-05-01 06:57:19 EEST" "2015-06-01 05:48:53 EEST"
## [5] "2015-07-01 05:42:30 EEST" "2015-08-01 06:41:16 EEST"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(dates, <span class="dt">geocode =</span> <span class="kw">data.frame</span>(<span class="dt">lat =</span> <span class="op">-</span><span class="dv">60</span>, <span class="dt">lon =</span> <span class="dv">0</span>))</code></pre></div>
<pre><code>## [1] "2015-03-01 07:12:45 EET"  "2015-04-01 09:29:25 EEST"
## [3] "2015-05-01 10:41:14 EEST" "2015-06-01 11:46:32 EEST"
## [5] "2015-07-01 12:03:42 EEST" "2015-08-01 11:14:28 EEST"</code></pre>
<p>The angle used in the twilight calculation can be supplied, either as the name of a standard definition, or as an angle in degrees (negative for sun positions below the horizon). Positive angles can be used when the time of sun occlusion behind a building, mountain, or other obstacle needs to be calculated. The default for <code>twilight</code> is <code>"none"</code> meaning that times correspond to the occlusion of the upper rim of the sun below the theoretical horizon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(<span class="kw">ymd</span>(<span class="st">"2017-03-21"</span>, <span class="dt">tz =</span> <span class="st">"EET"</span>), 
             <span class="dt">tz =</span> <span class="st">"EET"</span>, 
             <span class="dt">geocode =</span> my.geocode,
             <span class="dt">twilight =</span> <span class="st">"civil"</span>)</code></pre></div>
<pre><code>## [1] "2017-03-21 05:34:56 EET"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(<span class="kw">ymd</span>(<span class="st">"2017-03-21"</span>, <span class="dt">tz =</span> <span class="st">"EET"</span>), 
             <span class="dt">tz =</span> <span class="st">"EET"</span>, 
             <span class="dt">geocode =</span> my.geocode,
             <span class="dt">twilight =</span> <span class="op">-</span><span class="dv">10</span>)</code></pre></div>
<pre><code>## [1] "2017-03-21 05:01:34 EET"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(<span class="kw">ymd</span>(<span class="st">"2017-03-21"</span>, <span class="dt">tz =</span> <span class="st">"EET"</span>), 
             <span class="dt">tz =</span> <span class="st">"EET"</span>, 
             <span class="dt">geocode =</span> my.geocode,
             <span class="dt">twilight =</span> <span class="op">+</span><span class="dv">12</span>)</code></pre></div>
<pre><code>## [1] "2017-03-21 08:01:58 EET"</code></pre>
<p>Parameter <code>unit.out</code> can be used to obtain the returned value expressed as time-of-day in hours, minutes, or seconds since midnight, instead of the default <code>datetime</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(<span class="kw">ymd</span>(<span class="st">"2017-03-21"</span>, <span class="dt">tz =</span> <span class="st">"EET"</span>), 
             <span class="dt">tz =</span> <span class="st">"EET"</span>, 
             <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] "2017-03-21 06:16:50 EET"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">sunrise_time</a></span>(<span class="kw">ymd</span>(<span class="st">"2017-03-21"</span>, <span class="dt">tz =</span> <span class="st">"EET"</span>), 
             <span class="dt">tz =</span> <span class="st">"EET"</span>, 
             <span class="dt">geocode =</span> my.geocode,
             <span class="dt">unit.out =</span> <span class="st">"hours"</span>)</code></pre></div>
<pre><code>## [1] 6.280614</code></pre>
<p>Functions <code>day_length</code> and <code>night_length</code> return by default the length of time in hours.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">day_length</a></span>(dates, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] 10.37265 13.21916 15.93326 18.29610 18.80025 16.95222</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">night_length</a></span>(dates, <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>## [1] 13.627346 10.780844  8.066744  5.703898  5.199751  7.047784</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">day_length</a></span>(dates, <span class="dt">geocode =</span> my.geocode, <span class="dt">unit.out =</span> <span class="st">"days"</span>)</code></pre></div>
<pre><code>## [1] 0.4321939 0.5507982 0.6638857 0.7623376 0.7833437 0.7063423</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">night_length</a></span>(dates, <span class="dt">geocode =</span> my.geocode, <span class="dt">unit.out =</span> <span class="st">"days"</span>)</code></pre></div>
<pre><code>## [1] 0.5678061 0.4492018 0.3361143 0.2376624 0.2166563 0.2936577</code></pre>
<p>Function <code>day_night</code> returns a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">day_night</a></span>(dates[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], 
          <span class="dt">geocode =</span> my.geocode)</code></pre></div>
<pre><code>##          day              tz twilight.rise twilight.set longitude latitude
## 1 2015-03-01 Europe/Helsinki          none         none     24.93    60.16
## 2 2015-04-01 Europe/Helsinki          none         none     24.93    60.16
##             address  sunrise     noon   sunset daylength nightlength
## 1 Helsinki, Finland 7.426707 12.54357 17.66043  10.23372    13.76628
## 2 Helsinki, Finland 6.860139 13.40220 19.94426  13.08412    10.91588</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">day_night</a></span>(dates[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], 
          <span class="dt">geocode =</span> my.geocode, 
          <span class="dt">unit.out =</span> <span class="st">"days"</span>)</code></pre></div>
<pre><code>##          day              tz twilight.rise twilight.set longitude latitude
## 1 2015-03-01 Europe/Helsinki          none         none     24.93    60.16
## 2 2015-04-01 Europe/Helsinki          none         none     24.93    60.16
##             address   sunrise      noon    sunset daylength nightlength
## 1 Helsinki, Finland 0.3094461 0.5226486 0.7358512 0.4264051   0.5735949
## 2 Helsinki, Finland 0.2858391 0.5584249 0.8310108 0.5451716   0.4548284</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/day_night.html">day_night</a></span>(dates[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], 
          <span class="dt">geocode =</span> my.geocode, 
          <span class="dt">unit.out =</span> <span class="st">"datetime"</span>)</code></pre></div>
<pre><code>##          day              tz twilight.rise twilight.set longitude latitude
## 1 2015-03-01 Europe/Helsinki          none         none     24.93    60.16
## 2 2015-04-01 Europe/Helsinki          none         none     24.93    60.16
##             address             sunrise                noon
## 1 Helsinki, Finland 2015-03-01 07:25:36 2015-03-01 12:32:36
## 2 Helsinki, Finland 2015-04-01 06:51:36 2015-04-01 13:24:07
##                sunset daylength nightlength
## 1 2015-03-01 17:39:37  10.23372    13.76628
## 2 2015-04-01 19:56:39  13.08412    10.91588</code></pre>
</div>
<div id="solar-time" class="section level3">
<h3 class="hasAnchor">
<a href="#solar-time" class="anchor"></a>Solar time</h3>
<p>In field research it is in many cases preferable to sample or measure, and present and plot data based on local solar time. Two functions are provided. They differ in the value returned, either a time of day in hours, or a datetime.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Paris.geo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lon =</span> <span class="fl">2.352222</span>, <span class="dt">lat =</span> <span class="fl">48.85661</span>, <span class="dt">address =</span> <span class="st">"Paris"</span>)
Paris.time &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">"2016-09-30 06:00:00"</span>, <span class="dt">tz =</span> <span class="st">"UTC"</span>)
<span class="kw"><a href="../reference/solar_time.html">solar_time</a></span>(Paris.time, <span class="dt">geocode =</span> Paris.geo)</code></pre></div>
<pre><code>## [1] "06:19:33"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/solar_time.html">solar_time</a></span>(Paris.time, <span class="dt">geocode =</span> Paris.geo, <span class="dt">unit.out =</span> <span class="st">"datetime"</span>)</code></pre></div>
<pre><code>## [1] "2016-09-30 06:19:33 solar"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.solar.t &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solar_time.html">solar_time</a></span>(Paris.time, <span class="dt">geocode =</span> Paris.geo)
<span class="kw"><a href="../reference/is.solar_time.html">is.solar_time</a></span>(my.solar.t)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.numeric</span>(my.solar.t)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.solar.d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solar_time.html">solar_time</a></span>(Paris.time, <span class="dt">geocode =</span> Paris.geo, <span class="dt">unit.out =</span> <span class="st">"datetime"</span>)
<span class="kw"><a href="../reference/is.solar_time.html">is.solar_date</a></span>(my.solar.d)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.timepoint</span>(my.solar.d)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="time-of-day" class="section level3">
<h3 class="hasAnchor">
<a href="#time-of-day" class="anchor"></a>Time of day</h3>
<p>Function <code><a href="../reference/as_tod.html">as_tod()</a></code> facilitates conversion of R’s time date objects into a numeric value representing the time of day in one of hour, minute or second as unit of expression.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">times &lt;-<span class="st"> </span><span class="kw">now</span>() <span class="op">+</span><span class="st"> </span><span class="kw">hours</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">6</span>)
times</code></pre></div>
<pre><code>## [1] "2017-06-18 12:48:18 EEST" "2017-06-18 13:48:18 EEST"
## [3] "2017-06-18 14:48:18 EEST" "2017-06-18 15:48:18 EEST"
## [5] "2017-06-18 16:48:18 EEST" "2017-06-18 17:48:18 EEST"
## [7] "2017-06-18 18:48:18 EEST"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/as_tod.html">as_tod</a></span>(times)</code></pre></div>
<pre><code>## [1] 12.80516 13.80516 14.80516 15.80516 16.80516 17.80516 18.80516</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/as_tod.html">as_tod</a></span>(times, <span class="dt">unit.out =</span> <span class="st">"minutes"</span>)</code></pre></div>
<pre><code>## [1]  768.3094  828.3094  888.3094  948.3094 1008.3094 1068.3094 1128.3094</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#astronomy">Astronomy</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Pedro J. Aphalo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
