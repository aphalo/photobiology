<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>photobiology: Photobiological Calculations — photobiology-package • photobiology</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="photobiology: Photobiological Calculations — photobiology-package" />

<meta property="og:description" content="Definitions of classes, methods, operators and functions for use in
photobiology and radiation meteorology and climatology. Calculation of
effective (weighted) and not-weighted irradiances/doses, fluence rates,
transmittance, reflectance, absorptance, absorbance and diverse
ratios and other derived quantities from spectral data. Local maxima and
minima. Conversion between energy- and photon-based units. Wavelength
interpolation. Astronomical calculations related solar angles and day
length. Colours and vision. This package is part of the
'r4photobiology' suite, Aphalo P. J. (2015) &lt;doi:10.19232/uv4pb.2015.1.14&gt;." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">photobiology</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.9.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/userguide1-intro.html">User Guide: 1 Introduction</a>
    </li>
    <li>
      <a href="../articles/userguide2-radiation.html">User Guide: 2 Radiation</a>
    </li>
    <li>
      <a href="../articles/userguide3-astronomy.html">User Guide: 3 Astronomy</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>photobiology: Photobiological Calculations</h1>
    
    </div>

    
    <p>Definitions of classes, methods, operators and functions for use in
photobiology and radiation meteorology and climatology. Calculation of
effective (weighted) and not-weighted irradiances/doses, fluence rates,
transmittance, reflectance, absorptance, absorbance and diverse
ratios and other derived quantities from spectral data. Local maxima and
minima. Conversion between energy- and photon-based units. Wavelength
interpolation. Astronomical calculations related solar angles and day
length. Colours and vision. This package is part of the
'r4photobiology' suite, Aphalo P. J. (2015) &lt;doi:10.19232/uv4pb.2015.1.14&gt;.</p>
    

        
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Package 'photobiology' is at the core of a suite of packages for
  analysis and plotting of data relevant to photobiology (described at
  <a href='http://www.r4photobiology.info/'>http://www.r4photobiology.info/</a>). The accompanying packages (under
  development) provide data and definitions that are to a large extent
  application-area specific while the functions in the present package are
  widely useful in photobiology and radiation quantification in geophysics
  and meteorology. Package 'photobiology' has its main focus in the
  characterization of the light environment in a biologically relevant manner
  and in the manipulation of spectral data to simulate photo-physical,
  photo-chemical and photo-biological interactions and responses. The focus of
  package 'pavo' (Maia et al., 2003) is in colour perception by animals and
  assessment of animal coloration. In spite of the different focus, there is
  some degree of overlap.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Code for some of the astronomical calculations has been adapted from
  that in package 'pavo'.</p>
    
    <h2 class="hasAnchor" id="acknowledgements"><a class="anchor" href="#acknowledgements"></a>Acknowledgements</h2>

    <p>This work was funded by the Academy of Finland
  (decision 252548). COST Action FA9604 'UV4Growth' facilitated discussions
  and exchanges of ideas that lead to the development of this package. The
  contributions of Andy McLeod, Lars Olof Björn, Nigel Paul, Lasse Ylianttila,
  T. Matthew Robson and Titta Kotilainen were specially significant.
  Tutorials by Hadley Wickham and comments on my presentation at UseR!2015
  allowed me to significantly improve the coding and functionality.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Aphalo, P. J., Albert, A., Björn, L. O., McLeod, A. R., Robson, T. M.,
Rosenqvist, E. (Eds.). (2012). Beyond the Visible: A handbook of best
practice in plant UV photobiology (1st ed., p. xx + 174). Helsinki:
University of Helsinki, Department of Biosciences, Division of Plant Biology.
ISBN 978-952-10-8363-1 (PDF), 978-952-10-8362-4 (paperback). Open access PDF
download available at http://hdl.handle.net/10138/37558</p>
<p>Aphalo, Pedro J. (2015) The r4photobiology suite. UV4Plants Bulletin, 2015:1,
21-29. <a href='https://doi.org/10.19232/uv4pb.2015.1.14'>https://doi.org/10.19232/uv4pb.2015.1.14</a>.</p>
<p>Maia, R., Eliason, C. M., Bitton, P. P., Doucet, S. M., Shawkey, M. D. (2013)
pavo: an R package for the analysis, visualization and organization of
spectral data. Methods in Ecology and Evolution, 4(10):906-913.
<a href='https://doi.org/10.1111/2041-210X.12069'>https://doi.org/10.1111/2041-210X.12069</a>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Useful links:</p><ul>
<li><p><a href='http://www.r4photobiology.info/'>http://www.r4photobiology.info/</a></p></li>
<li><p><a href='https://bitbucket.org/aphalo/photobiology'>https://bitbucket.org/aphalo/photobiology</a></p></li>
<li><p>Report bugs at <a href='https://bitbucket.org/aphalo/photobiology/issues'>https://bitbucket.org/aphalo/photobiology/issues</a></p></li>
</ul></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># irradiance of the whole spectrum</span>
<span class='fu'><a href='irrad.html'>irrad</a></span>(<span class='no'>sun.spct</span>)</div><div class='output co'>#&gt;    Total 
#&gt; 269.1249 
#&gt; attr(,"time.unit")
#&gt; [1] "second"
#&gt; attr(,"radiation.unit")
#&gt; [1] "energy irradiance total"</div><div class='input'><span class='co'># photon irradiance 400 nm to 700 nm</span>
<span class='fu'><a href='q_irrad.html'>q_irrad</a></span>(<span class='no'>sun.spct</span>, <span class='fu'><a href='waveband.html'>waveband</a></span>(<span class='fu'>c</span>(<span class='fl'>400</span>,<span class='fl'>700</span>)))</div><div class='output co'>#&gt;  range.400.700 
#&gt;   0.0008941352 
#&gt; attr(,"time.unit")
#&gt; [1] "second"
#&gt; attr(,"radiation.unit")
#&gt; [1] "photon irradiance total"</div><div class='input'><span class='co'># energy irradiance 400 nm to 700 nm</span>
<span class='fu'><a href='e_irrad.html'>e_irrad</a></span>(<span class='no'>sun.spct</span>, <span class='fu'><a href='waveband.html'>waveband</a></span>(<span class='fu'>c</span>(<span class='fl'>400</span>,<span class='fl'>700</span>)))</div><div class='output co'>#&gt;  range.400.700 
#&gt;       196.6343 
#&gt; attr(,"time.unit")
#&gt; [1] "second"
#&gt; attr(,"radiation.unit")
#&gt; [1] "energy irradiance total"</div><div class='input'><span class='co'># simulating the effect of a filter on solar irradiance</span>
<span class='fu'><a href='e_irrad.html'>e_irrad</a></span>(<span class='no'>sun.spct</span> * <span class='no'>yellow_gel.spct</span>, <span class='fu'><a href='waveband.html'>waveband</a></span>(<span class='fu'>c</span>(<span class='fl'>400</span>,<span class='fl'>500</span>)))</div><div class='output co'>#&gt;  range.400.500 
#&gt;       2.086211 
#&gt; attr(,"time.unit")
#&gt; [1] "second"
#&gt; attr(,"radiation.unit")
#&gt; [1] "energy irradiance total"</div><div class='input'><span class='fu'><a href='e_irrad.html'>e_irrad</a></span>(<span class='no'>sun.spct</span> * <span class='no'>yellow_gel.spct</span>, <span class='fu'><a href='waveband.html'>waveband</a></span>(<span class='fu'>c</span>(<span class='fl'>500</span>,<span class='fl'>700</span>)))</div><div class='output co'>#&gt;  range.500.700 
#&gt;       104.8818 
#&gt; attr(,"time.unit")
#&gt; [1] "second"
#&gt; attr(,"radiation.unit")
#&gt; [1] "energy irradiance total"</div><div class='input'><span class='co'># daylength</span>
<span class='fu'><a href='day_night.html'>sunrise_time</a></span>(<span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/today.html'>today</a></span>(<span class='kw'>tzone</span> <span class='kw'>=</span> <span class='st'>"EET"</span>), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='st'>"EET"</span>,
             <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>60</span>, <span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>25</span>), <span class='kw'>unit.out</span> <span class='kw'>=</span> <span class='st'>"hour"</span>)</div><div class='output co'>#&gt; [1] 6.682147</div><div class='input'><span class='fu'><a href='day_night.html'>day_length</a></span>(<span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/today.html'>today</a></span>(<span class='kw'>tzone</span> <span class='kw'>=</span> <span class='st'>"EET"</span>), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='st'>"EET"</span>,
           <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>60</span>, <span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>25</span>), <span class='kw'>unit.out</span> <span class='kw'>=</span> <span class='st'>"hour"</span>)</div><div class='output co'>#&gt; [1] 13.41823</div><div class='input'><span class='co'># colour as seen by humans</span>
<span class='fu'><a href='color_of.html'>color_of</a></span>(<span class='no'>sun.spct</span>)</div><div class='output co'>#&gt; source CMF 
#&gt;  "#544F4B" </div><div class='input'><span class='fu'><a href='color_of.html'>color_of</a></span>(<span class='no'>sun.spct</span> * <span class='no'>yellow_gel.spct</span>)</div><div class='output co'>#&gt; source CMF 
#&gt;  "#946000" </div><div class='input'><span class='co'># filter transmittance</span>
<span class='fu'><a href='transmittance.html'>transmittance</a></span>(<span class='no'>yellow_gel.spct</span>)</div><div class='output co'>#&gt;     Total 
#&gt; 0.4260133 
#&gt; attr(,"Tfr.type")
#&gt; [1] "total"
#&gt; attr(,"radiation.unit")
#&gt; [1] "transmittance average"</div><div class='input'><span class='fu'><a href='transmittance.html'>transmittance</a></span>(<span class='no'>yellow_gel.spct</span>, <span class='fu'><a href='waveband.html'>waveband</a></span>(<span class='fu'>c</span>(<span class='fl'>400</span>,<span class='fl'>500</span>)))</div><div class='output co'>#&gt;  range.400.500 
#&gt;     0.02832715 
#&gt; attr(,"Tfr.type")
#&gt; [1] "total"
#&gt; attr(,"radiation.unit")
#&gt; [1] "transmittance average"</div><div class='input'><span class='fu'><a href='transmittance.html'>transmittance</a></span>(<span class='no'>yellow_gel.spct</span>, <span class='fu'><a href='waveband.html'>waveband</a></span>(<span class='fu'>c</span>(<span class='fl'>500</span>,<span class='fl'>700</span>)))</div><div class='output co'>#&gt;  range.500.700 
#&gt;      0.8341062 
#&gt; attr(,"Tfr.type")
#&gt; [1] "total"
#&gt; attr(,"radiation.unit")
#&gt; [1] "transmittance average"</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#acknowledgements">Acknowledgements</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
<strong>Maintainer</strong>: Pedro J. Aphalo <a href='mailto:pedro.aphalo@helsinki.fi'>pedro.aphalo@helsinki.fi</a> (https://orcid.org/0000-0003-3385-972X)

Other contributors:
<ul>
<li><p>Titta K. Kotilainen (http://orcid.org/0000-0002-2822-9734) [contributor]</p></li>
<li><p>Glenn Davis <a href='mailto:gdavis@gluonics.com'>gdavis@gluonics.com</a> [contributor]</p></li>
</ul>


  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Pedro J. Aphalo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

