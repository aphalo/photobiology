<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Times for sun positions — day_night â€¢ photobiology</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">photobiology</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../reference/photobiology-package.html">About</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Times for sun positions</h1>
    </div>

    
    <p>Functions for calculating the timing of solar positions by means of function
<code>sun_angles</code>, given geographical coordinates and dates. They can be also
used to find the time for an arbitrary solar elevation between 90 and -90
degrees by supplying "twilight" angle(s) as argument.</p>
    

    <pre class="usage"><span class='fu'>day_night</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='kw'>lubridate</span><span class='kw'>::</span><span class='fu'>now</span>(<span class='kw'>tzone</span> <span class='kw'>=</span> <span class='st'>"UTC"</span>), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='kw'>lubridate</span><span class='kw'>::</span><span class='fu'>tz</span>(<span class='no'>date</span>),
  <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>),
  <span class='kw'>twilight</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>unit.out</span> <span class='kw'>=</span> <span class='st'>"hours"</span>)

<span class='fu'>day_night_fast</span>(<span class='no'>date</span>, <span class='no'>tz</span>, <span class='no'>geocode</span>, <span class='no'>twilight</span>, <span class='no'>unit.out</span>)

<span class='fu'>noon_time</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='kw'>lubridate</span><span class='kw'>::</span><span class='fu'>today</span>(), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='fu'>Sys.timezone</span>(),
  <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>),
  <span class='kw'>twilight</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>unit.out</span> <span class='kw'>=</span> <span class='st'>"datetime"</span>)

<span class='fu'>sunrise_time</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='kw'>lubridate</span><span class='kw'>::</span><span class='fu'>today</span>(), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='fu'>Sys.timezone</span>(),
  <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>),
  <span class='kw'>twilight</span> <span class='kw'>=</span> <span class='st'>"sunlight"</span>, <span class='kw'>unit.out</span> <span class='kw'>=</span> <span class='st'>"datetime"</span>)

<span class='fu'>sunset_time</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='kw'>lubridate</span><span class='kw'>::</span><span class='fu'>today</span>(), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='fu'>Sys.timezone</span>(),
  <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>),
  <span class='kw'>twilight</span> <span class='kw'>=</span> <span class='st'>"sunlight"</span>, <span class='kw'>unit.out</span> <span class='kw'>=</span> <span class='st'>"datetime"</span>)

<span class='fu'>day_length</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='kw'>lubridate</span><span class='kw'>::</span><span class='fu'>now</span>(), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='st'>"UTC"</span>, <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span> <span class='kw'>=</span>
  <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>), <span class='kw'>twilight</span> <span class='kw'>=</span> <span class='st'>"sunlight"</span>,
  <span class='kw'>unit.out</span> <span class='kw'>=</span> <span class='st'>"hours"</span>)

<span class='fu'>night_length</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='kw'>lubridate</span><span class='kw'>::</span><span class='fu'>now</span>(), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='st'>"UTC"</span>, <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span>
  <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>), <span class='kw'>twilight</span> <span class='kw'>=</span> <span class='st'>"sunlight"</span>,
  <span class='kw'>unit.out</span> <span class='kw'>=</span> <span class='st'>"hours"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>date</th>
      <td><p>"vector" of POSIXct times or Date objects, any valid TZ is allowed,
default is current date</p></td>
    </tr>
    <tr>
      <th>tz</th>
      <td><p>character vector indicating time zone to be used in output.</p></td>
    </tr>
    <tr>
      <th>geocode</th>
      <td><p>data frame with one or more rows and variables lon and lat as
numeric values (degrees). If present, address will be copied to the output.</p></td>
    </tr>
    <tr>
      <th>twilight</th>
      <td><p>character string, one of "none", "civil", "nautical",
"astronomical", or a <code>numeric</code> vector of length one, or two, giving
solar elevation angle(s) in degrees (negative if below the horizon).</p></td>
    </tr>
    <tr>
      <th>unit.out</th>
      <td><p>charater string, One of "datetime", "day", "hour", "minute",
or "second".</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame with variables day, tz, twilight.rise, twilight.set,
  longitude, latitude, address, sunrise, noon, sunset, daylength,
  nightlength.

<code>noon_time</code>, <code>sunrise_time</code> and <code>sunset_time</code> return a
  vector of POSIXct times

<code>day_length</code> and <code>night_length</code> return numeric a vector
  giving the length in hours</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Twilight names are interpreted as follows. "none": solar elevation =
  0 degrees. "refraction": solar elevation = 0 degrees + refraction
  correction. "sunlight": upper rim of solar disk corrected for refraction.
  "civil": -6 degrees, "naval": -12 degrees, and "astronomical": -18 degrees.
  Unit names for output are as follows: "hours" times for sunrise and sunset
  are returned as times-of-day in hours since middnight. "date" or "datetime"
  return the same times as datetime objects with TZ set (this is much slower
  than the "hours"). Day length and night length are returned as numeric
  values expressed in hours when `"datetime"' is paseed as argument to
  <code>unit.out</code>. If twilight is a numeric vector of length two,
  the element with index 1 is used for sunrise and that with index 2 for
  sunset.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function is an implementation of Meeus equations as used in NOAAs
  on-line web calculator, which are very precise and valid for a very broad
  range of dates. For sunrise and sunset the times are affected by refraction
  in the atmosphere, which does in turn depend on weather conditions. The
  effect of refraction on the apparent position of the sun is only an
  estimate based on "typical" conditions. The more tangential to the horizon
  is the path of the sun, the larger the effect of refraction is on the times
  of visual occlusion of the sun behind the horizon---i.e. the largest timing
  errors occur at high latitudes. The computation is not defined for
  latitudes 90 and -90 degrees, i.e. at the poles.</p>
<p>There exists a different R implementation of the same algorithms called
  "AstroCalcPureR" available as function <code>astrocalc4r</code> in package
  'fishmethods'. Although the equations used are almost all the same, the
  function signatures and which values are returned differ. In particular,
  the present implementation splits the calcualtion into two separate
  functions, one returning angles at given instants in time, and a separate
  one returning the timing of events for given dates.
    <code>night_length</code> returns the length of night-time conditions in one
  day (00:00:00 to 23:59:59), rather than the length of the night between two
  consequtive days.</p>
    
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>Be aware that R's <code>Date</code> class does not save time zone
  metadata. This can lead to ambiguities in the current implementation as
  based on time instants. The argument passed to <code>date</code> should be
  of class <code>POSIXct</code>, in other words an instant in time, from which
  the correct date will be computed based on the <code>tz</code> argument.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='sun_angles.html'>sun_angles</a></code>.</p>
<p>Other astronomy related functions: <code><a href='format.solar_time.html'>format.solar_time</a></code>,
  <code><a href='is.solar_time.html'>is.solar_time</a></code>,
  <code><a href='print.solar_time.html'>print.solar_time</a></code>, <code><a href='solar_time.html'>solar_time</a></code>,
  <code><a href='sun_angles.html'>sun_angles</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>lubridate</span>)
<span class='no'>my.geocode</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>60</span>, <span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>25</span>)
<span class='fu'>day_night</span>(<span class='fu'>ymd</span>(<span class='st'>"2015-05-30"</span>), <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='no'>my.geocode</span>)</div><div class='output co'>#&gt;          day  tz twilight.rise twilight.set longitude latitude address  sunrise
#&gt; 1 2015-05-30 UTC             0            0        25       60    &lt;NA&gt; 1.368398
#&gt;       noon   sunset daylength nightlength
#&gt; 1 10.29246 19.21651  17.84812    6.151883</div><div class='input'><span class='fu'>day_night</span>(<span class='fu'>ymd</span>(<span class='st'>"2015-05-30"</span>) + <span class='fu'>days</span>(<span class='fl'>1</span>:<span class='fl'>10</span>), <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='no'>my.geocode</span>, <span class='kw'>twilight</span> <span class='kw'>=</span> <span class='st'>"civil"</span>)</div><div class='output co'>#&gt;           day  tz twilight.rise twilight.set longitude latitude address
#&gt; 1  2015-05-31 UTC            -6           -6        25       60    &lt;NA&gt;
#&gt; 2  2015-06-01 UTC            -6           -6        25       60    &lt;NA&gt;
#&gt; 3  2015-06-02 UTC            -6           -6        25       60    &lt;NA&gt;
#&gt; 4  2015-06-03 UTC            -6           -6        25       60    &lt;NA&gt;
#&gt; 5  2015-06-04 UTC            -6           -6        25       60    &lt;NA&gt;
#&gt; 6  2015-06-05 UTC            -6           -6        25       60    &lt;NA&gt;
#&gt; 7  2015-06-06 UTC            -6           -6        25       60    &lt;NA&gt;
#&gt; 8  2015-06-07 UTC            -6           -6        25       60    &lt;NA&gt;
#&gt;     sunrise     noon   sunset daylength nightlength
#&gt; 1  23.80018 10.29485 20.78952  20.98934    3.010664
#&gt; 2  23.75166 10.29736 20.84305  21.09140    2.908601
#&gt; 3  23.70388 10.29997 20.89606  21.19219    2.807812
#&gt; 4  23.65693 10.30269 20.94845  21.29152    2.708483
#&gt; 5  23.61092 10.30551 21.00009  21.38918    2.610823
#&gt; 6  23.56595 10.30842 21.05088  21.48493    2.515070
#&gt; 7  23.52217 10.31142 21.10067  21.57851    2.421495
#&gt; 8  23.47970 10.31450 21.14930  21.66960    2.330400
#&gt;  [ reached getOption("max.print") -- omitted 2 rows ]</div><div class='input'><span class='fu'>sunrise_time</span>(<span class='fu'>ymd</span>(<span class='st'>"2015-05-30"</span>), <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='no'>my.geocode</span>)</div><div class='output co'>#&gt; [1] "2015-05-30 04:11:55 EEST"</div><div class='input'><span class='fu'>noon_time</span>(<span class='fu'>ymd</span>(<span class='st'>"2015-05-30"</span>), <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='no'>my.geocode</span>)</div><div class='output co'>#&gt; [1] "2015-05-30 13:17:32 EEST"</div><div class='input'><span class='fu'>sunset_time</span>(<span class='fu'>ymd</span>(<span class='st'>"2015-05-30"</span>), <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='no'>my.geocode</span>)</div><div class='output co'>#&gt; [1] "2015-05-30 22:23:09 EEST"</div><div class='input'><span class='fu'>day_length</span>(<span class='fu'>ymd</span>(<span class='st'>"2015-05-30"</span>), <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='no'>my.geocode</span>)</div><div class='output co'>#&gt; [1] 18.18727</div><div class='input'><span class='fu'>day_length</span>(<span class='fu'>ymd</span>(<span class='st'>"2015-05-30"</span>), <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='no'>my.geocode</span>, <span class='kw'>unit.out</span> <span class='kw'>=</span> <span class='st'>"day"</span>)</div><div class='output co'>#&gt; [1] 0.7578028</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#warning">Warning</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Pedro J. Aphalo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
