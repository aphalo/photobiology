<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Solar angles — sun_angles â€¢ photobiology</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">photobiology</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/userguide1-intro.html">User Guide: 1 Introduction</a>
    </li>
    <li>
      <a href="../articles/userguide2-radiation.html">User Guide: 2 Radiation</a>
    </li>
    <li>
      <a href="../articles/userguide3-astronomy.html">User Guide: 3 Astronomy</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Solar angles</h1>
    </div>

    
    <p>This function returns the solar angles for a given time and location.</p>
    

    <pre class="usage"><span class='fu'>sun_angles</span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/now.html'>now</a></span>(<span class='kw'>tzone</span> <span class='kw'>=</span> <span class='st'>"UTC"</span>), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/tz.html'>tz</a></span>(<span class='no'>time</span>),
  <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>),
  <span class='kw'>use.refraction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>sun_angles_fast</span>(<span class='no'>time</span>, <span class='no'>tz</span>, <span class='no'>geocode</span>, <span class='no'>use.refraction</span>)

<span class='fu'>sun_elevation</span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/now.html'>now</a></span>(), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/tz.html'>tz</a></span>(<span class='no'>time</span>),
  <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>),
  <span class='kw'>use.refraction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>sun_zenith_angle</span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/now.html'>now</a></span>(), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/tz.html'>tz</a></span>(<span class='no'>time</span>),
  <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>),
  <span class='kw'>use.refraction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>sun_azimuth</span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/now.html'>now</a></span>(), <span class='kw'>tz</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/tz.html'>tz</a></span>(<span class='no'>time</span>),
  <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lon</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>lat</span> <span class='kw'>=</span> <span class='fl'>51.5</span>, <span class='kw'>address</span> <span class='kw'>=</span> <span class='st'>"Greenwich"</span>),
  <span class='kw'>use.refraction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>time</th>
      <td><p>A "vector" of POSIXct Time, with any valid time zone (TZ) is
allowed, default is current time.</p></td>
    </tr>
    <tr>
      <th>tz</th>
      <td><p>character string indicating time zone to be used in output.</p></td>
    </tr>
    <tr>
      <th>geocode</th>
      <td><p>data frame with variables lon and lat as numeric values
(degrees), nrow &gt; 1, allowed.</p></td>
    </tr>
    <tr>
      <th>use.refraction</th>
      <td><p>logical Flag indicating whether to correct for
fraction in the atmosphere.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame with variables time (in same TZ as input), TZ, solartime,
  longitude, latitude, address, azimuth, and elevation. If a data frame with
  multiple rows is passed to <code>geocode</code> and a vector of times longer
  than one is passed to <code>time</code>, sun position for all combinations of
  locations and times are returned are returned by <code>sun_angles</code>. In
  contrast, convenience functions returning a vector, require that either
  a single time instant or a single location are supplied---i.e. only
  one of these two arguments can be vectorized in a given call.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function is an implementation of Meeus equations as used in NOAAs
  on-line web calculator, which are very precise and valid for a very broad
  range of dates. For the times of sunrise and sunset the times are affected
  by refraction in the atmosphere, which does in turn depend on weather
  conditions. The effect of refraction on the apparent position of the sun
  is only an estimate based on "typical" conditions. The more tangential to
  the horizon is the path of the sun, the larger the effect of refraction is
  on the times of visual occlusion of the sun behind the horizon---i.e. the
  largest timing errors occur at high latitudes.
  The computation is not defined for latitudes 90 and -90 degrees, i.e. at
  the poles.
  There exists a different R implementation of the same algorithms called
  "AstroCalcPureR" available as function <code>astrocalc4r</code> in package
  'fishmethods'. Although the equations used are almost all the same, the
  function signatures and which values are returned differ. In particular,
  the present implementation splits the calculation into two separate
  functions, one returning angles at given instants in time, and a
  separate one returning the timing of events for given dates.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>Other astronomy related functions: <code><a href='day_night.html'>day_night</a></code>,
  <code><a href='format.solar_time.html'>format.solar_time</a></code>,
  <code><a href='is.solar_time.html'>is.solar_time</a></code>,
  <code><a href='print.solar_time.html'>print.solar_time</a></code>, <code><a href='solar_time.html'>solar_time</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>lubridate</span>)
<span class='fu'>sun_angles</span>()</div><div class='output co'>#&gt;                  time  tz solartime longitude latitude   address  azimuth
#&gt; 1 2018-03-31 18:27:16 UTC  18:23:17         0     51.5 Greenwich 277.3291
#&gt;    elevation
#&gt; 1 -0.1207211</div><div class='input'><span class='fu'>sun_azimuth</span>()</div><div class='output co'>#&gt; [1] 277.3291</div><div class='input'><span class='fu'>sun_elevation</span>()</div><div class='output co'>#&gt; [1] -0.1207545</div><div class='input'><span class='fu'>sun_zenith_angle</span>()</div><div class='output co'>#&gt; [1] 90.12076</div><div class='input'><span class='fu'>sun_angles</span>(<span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd_hms.html'>ymd_hms</a></span>(<span class='st'>"2014-09-23 12:00:00"</span>))</div><div class='output co'>#&gt;                  time  tz solartime longitude latitude   address  azimuth
#&gt; 1 2014-09-23 12:00:00 UTC  12:07:41         0     51.5 Greenwich 182.4467
#&gt;   elevation
#&gt; 1  38.20657</div><div class='input'><span class='fu'>sun_angles</span>(<span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd_hms.html'>ymd_hms</a></span>(<span class='st'>"2014-09-23 12:00:00"</span>),
           <span class='kw'>geocode</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>lat</span><span class='kw'>=</span><span class='fl'>60</span>, <span class='kw'>lon</span><span class='kw'>=</span><span class='fl'>0</span>))</div><div class='output co'>#&gt;                  time  tz solartime longitude latitude address  azimuth
#&gt; 1 2014-09-23 12:00:00 UTC  12:07:41         0       60    &lt;NA&gt; 182.2136
#&gt;   elevation
#&gt; 1  29.71356</div><div class='input'><span class='fu'>sun_angles</span>(<span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd_hms.html'>ymd_hms</a></span>(<span class='st'>"2014-09-23 12:00:00"</span>) + <span class='fu'><a href='http://lubridate.tidyverse.org/reference/period.html'>minutes</a></span>((<span class='fl'>0</span>:<span class='fl'>6</span>) * <span class='fl'>10</span>))</div><div class='output co'>#&gt;                  time  tz solartime longitude latitude   address  azimuth
#&gt; 1 2014-09-23 12:00:00 UTC  12:07:41         0     51.5 Greenwich 182.4467
#&gt; 2 2014-09-23 12:10:00 UTC  12:17:41         0     51.5 Greenwich 185.6235
#&gt; 3 2014-09-23 12:20:00 UTC  12:27:41         0     51.5 Greenwich 188.7868
#&gt; 4 2014-09-23 12:30:00 UTC  12:37:41         0     51.5 Greenwich 191.9294
#&gt; 5 2014-09-23 12:40:00 UTC  12:47:41         0     51.5 Greenwich 195.0447
#&gt; 6 2014-09-23 12:50:00 UTC  12:57:42         0     51.5 Greenwich 198.1265
#&gt; 7 2014-09-23 13:00:00 UTC  13:07:42         0     51.5 Greenwich 201.1693
#&gt;   elevation
#&gt; 1  38.20657
#&gt; 2  38.09432
#&gt; 3  37.89637
#&gt; 4  37.61378
#&gt; 5  37.24803
#&gt; 6  36.80100
#&gt; 7  36.27491</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Pedro J. Aphalo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
